<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" 
	xmlns:component="info.emantis.view.component.*" creationComplete="doShow(event)">
	<mx:Script>
		<![CDATA[
			import model.vo.SiteVO;
			import model.KioskModelLocator;
			import views.components.SiteHighlight;
			import mx.controls.Alert;
			import flash.utils.Timer;
    		import flash.events.TimerEvent;
	
			private static const HIGHLIGHT_DELAY:int = 3000;
	
			[Embed(source="images/continents.svg")]
			[Bindable]
			private var map:Class;
			
			private var highlightTimer:Timer;
			private var currentHighlight:SiteHighlight;
			
			public function doShow(event:Event):void {
            	this.highlightTimer = new Timer(HIGHLIGHT_DELAY, 0 );
            	this.highlightTimer.addEventListener( "timer" , showNextHighlight );
            	this.highlightTimer.start();
        	}

        	public function showNextHighlight(event:TimerEvent):void {
        		var index:int = 0;
        		if(this.currentHighlight) {
        			index = KioskModelLocator.getInstance().sites.getItemIndex(currentHighlight.site);
        			this.removeChild(currentHighlight);
        		}
				index < KioskModelLocator.getInstance().sites.length-1?index++:index=0;
				currentHighlight = new SiteHighlight();
				currentHighlight.site = SiteVO(KioskModelLocator.getInstance().sites.getItemAt(index));
				currentHighlight.x = currentHighlight.site.xPosition;
				currentHighlight.y = currentHighlight.site.yPosition;
				this.addChild(currentHighlight);
        	}
			
		]]>
	</mx:Script>
	<mx:Image source="{map}" width="100%" />
</mx:Canvas>